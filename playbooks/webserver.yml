---
- hosts: websrv
  remote_user: ffweingarten
  become: true
  gather_facts: true
  vars:
    mountpoint: "/mnt/web_backup"
  roles:
   - role: devsec.hardening.ssh_hardening
     sftp_enabled: true
   - role: devsec.hardening.os_hardening
   - role: geerlingguy.ntp
     vars:
        ntp_timezone: Europe/Berlin
   - role: nfs
     vars:
        permissions: "644"
        nfs_src: stark.feuerwehr.weingarten.local:/Web_Backup
        options: vers=4,rw,rsize=8192,wsize=8192,timeo=14,intr
   - role: geerlingguy.apache
     vars:
      apache_create_vhosts: true
      apache_vhosts:
        - servername: "test1.ff-weingarten.de"
          documentroot: "/var/www/vhosts/hydrant.ff-weingarten.de" 
          serveradmin: "admin@ff-weingarten.de"
        - servername: "test2.ff-weingarten.de"
          documentroot: "/var/www/vhosts/rainloop.ff-weingarten.de"
          serveradmin: "admin@ff-weingarten.de"
          options: +Indexes +FollowSymLinks +ExecCGI
   - role: geerlingguy.php
     vars_file:
      - roles/php/vars/main.yml
   - role: fauust.mariadb
   - role: webserver