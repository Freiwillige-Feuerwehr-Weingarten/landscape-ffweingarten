---
# This will install Firebird
#

- import_tasks: install-firebird.yml

- import_tasks: restore-db.yml
  when: restore_db

- name: Create Draegerware database alias
  lineinfile:
   dest: /etc/firebird/3.0/databases.conf
   line: "draegerware = /opt/draeger/DRAEGERWARE.FDB"
   state: present
  notify: restart firebird
  when: create_alias

#- name: setup firebird.conf
#  template:
#     backup: yes
#     dest: /etc/firebird/firebird.conf
#     group: firebird
#     owner: firebird
#     mode: 0644
#     src: firebird.conf.j2

# Set SYSDBA password
- import_tasks: sysdba-pass.yml
  when: sysdba_pass

- name: Copy backup script
  ansible.builtin.copy:
    src: files/firebirdbackup
    dest: /etc/cron.daily/
    mode: 0755
  when: setup_backup
